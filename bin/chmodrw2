#!/usr/bin/python2
import os
import stat
import getopt
import sys
import dircache

def chmodrw(path):
    if os.path.isdir(path):
        files = dircache.listdir(path)
        print files
        for file in files:
            chmodrw(path + "/" + file)
        os.chmod(path, stat.S_IRUSR | stat.S_IWUSR | stat.S_IXUSR | stat.S_IRGRP | stat.S_IXGRP | stat.S_IROTH | stat.S_IXOTH)
    else:
        os.chmod(path, stat.S_IRUSR | stat.S_IWUSR | stat.S_IRGRP | stat.S_IROTH)

optlist, args = getopt.getopt(sys.argv[1:], 'p:')
#print optlist
for o, a in optlist:
    if (o == '-p'):
        chmodrw(a)
        sys.exit(0)
#chmodrw(".")
